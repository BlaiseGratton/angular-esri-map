!function(e){"use strict";e.module("esri.core",[])}(angular),function(e){"use strict";e.module("esri.core").factory("esriLoader",["$q",function(r){function t(t){var n=r.defer();e.isDefined(window.esri)&&n.reject("ESRI API is already loaded."),t=e.isDefined(t)?t:{};var i=document.createElement("script");return i.type="text/javascript",i.src=t.url||"http://js.arcgis.com/3.14compact",i.onload=function(){n.resolve(window.esri)},document.body.appendChild(i),n.promise}function n(){return e.isDefined(window.esri)}function i(t,i){var a=r.defer();return n()?(e.isString(t)?require([t],function(r){i&&e.isFunction(i)&&i(r),a.resolve(r)}):e.isArray(t)?require(t,function(){var r=Array.prototype.slice.call(arguments);i&&e.isFunction(i)&&i.apply(this,r),a.resolve(r)}):a.reject("An Array<String> or String is required to load modules."),a.promise):(a.reject("Trying to call esriLoader.require(), but esri API has not been loaded yet. Run esriLoader.bootstrap() if you are lazy loading esri ArcGIS API."),a.promise)}return{bootstrap:t,isLoaded:n,require:i}}])}(angular),function(e){"use strict";e.module("esri.core").service("esriRegistry",["$q",function(e){var r={};return{_register:function(t,n){r[t]||(r[t]=e.defer());var i=r[t];return n.then(function(e){return i.resolve(e),e},function(e){return i.reject(e),e}),function(){delete r[t]}},get:function(t){if(r[t])return r[t].promise;var n=e.defer();return r[t]=n,n.promise}}}])}(angular),function(e){"use strict";e.module("esri.core").factory("esriMapUtils",["$q","esriLoader",function(r,t){function n(e,r){return"esri.geometry.Extent"===e.declaredClass?e:new r(e)}var i={};return i.addCustomBasemap=function(r,n){return t.require("esri/basemaps").then(function(t){var i=n.baseMapLayers;return!e.isArray(i)&&e.isArray(n.urls)&&(i=n.urls.map(function(e){return{url:e}})),e.isArray(i)&&(t[r]={baseMapLayers:i,thumbnailUrl:n.thumbnailUrl,title:n.title}),t})},i.createMap=function(e,r){return t.require(["esri/map","esri/geometry/Extent"]).then(function(t){var i=t[0],a=t[1];return r&&r.hasOwnProperty("extent")&&(r.extent=n(r.extent,a)),new i(e,r)})},i.createWebMap=function(e,i,a,o){var s=r.defer();return t.require(["esri/arcgis/utils","esri/geometry/Extent"],function(r,t){a.hasOwnProperty("extent")&&(a.extent=n(a.extent,t)),r.createMap(e,i,{mapOptions:a}).then(function(e){o.layerInfos=r.getLegendLayers(e),o.itemInfo=e.itemInfo,s.resolve(e.map)})}),s.promise},i}])}(angular),function(e){"use strict";e.module("esri.core").factory("esriLayerUtils",["esriLoader",function(r){function t(e){var r;return"string"==typeof e&&(r=[],e.split(",").forEach(function(e){var t=parseInt(e);isNaN(t)||r.push(t)})),r}function n(r,t){return"esri.InfoTemplate"===r.declaredClass?r:e.isArray(r)&&2===r.length?new t(r[0],r[1]):new t(r.title,r.content)}var i={};return i.createFeatureLayer=function(e,t){return r.require(["esri/layers/FeatureLayer","esri/InfoTemplate"]).then(function(r){var i=r[0],a=r[1];return t&&(t.infoTemplate&&(t.infoTemplate=n(t.infoTemplate,a)),t.hasOwnProperty("mode")&&(t.mode=i[t.mode])),new i(e,t)})},i.createDynamicMapServiceLayer=function(i,a,o){return r.require(["esri/layers/ArcGISDynamicMapServiceLayer","esri/InfoTemplate","esri/layers/ImageParameters"]).then(function(r){var s,u=r[0],l=r[1],c=r[2];if(a){if(a.infoTemplates)for(var f in a.infoTemplates)a.infoTemplates.hasOwnProperty(f)&&(a.infoTemplates[f].infoTemplate=n(a.infoTemplates[f].infoTemplate,l));if(e.isObject(a.imageParameters)&&"esri.layers.ImageParameters"!==a.imageParameters.declaredClass){var p=new c;for(var d in a.imageParameters)a.imageParameters.hasOwnProperty(d)&&(p[d]=a.imageParameters[d]);a.imageParameters=p}}return s=new u(i,a),o&&s.setVisibleLayers(t(o)),s})},i.createInfoTemplate=function(e){return r.require("esri/InfoTemplate").then(function(r){return n(e,r)})},i}])}(angular),function(e){"use strict";e.module("esri.map",["esri.core"])}(angular),function(e){"use strict";e.module("esri.map").controller("EsriMapController",["$attrs","$timeout","esriMapUtils","esriRegistry",function(r,t,n,i){function a(e,r){var t=r.geographicExtent&&r.geographicExtent.getCenter();t&&(t=t.normalize(),e.center={lat:t.y,lng:t.x}),e.zoom=r.getZoom()}var o,s=r;this.getMapOptions=function(){var e=this.mapOptions()||{};return this.basemap&&(e.basemap=this.basemap),this.center&&(e.center=this.center.lng&&this.center.lat?[this.center.lng,this.center.lat]:this.center),this.zoom&&(e.zoom=this.zoom),e},this.getMap=function(){return o},this.addLayer=function(e,r){return this.getMap().then(function(t){return t.addLayer(e,r)})},this.removeLayer=function(e){return this.getMap().then(function(r){return r.removeLayer(e)})},this.addLayerInfo=function(e){this.layerInfos?this.layerInfos.unshift(e):this.layerInfos=[e]},this.getLayerInfos=function(){return this.layerInfos},this.bindMapEvents=function(r,n){var i=this;this.getMap().then(function(o){o.loaded?(a(i,o),n.load&&i.load()(o)):n.load&&o.on("load",function(){r.$apply(function(){i.load()(o)})}),o.on("extent-change",function(e){n.extentChange&&i.extentChange()(e),i.inUpdateCycle||(i.inUpdateCycle=!0,r.$apply(function(){a(i,o),t(function(){i.inUpdateCycle=!1},0)}))}),r.$watch("mapCtrl.basemap",function(e,r){o.loaded&&e!==r&&o.setBasemap(e)}),i.inUpdateCycle=!1,e.isUndefined(n.center)&&e.isUndefined(n.zoom)||r.$watchGroup(["mapCtrl.center.lng","mapCtrl.center.lat","mapCtrl.zoom"],function(e){i.inUpdateCycle||""!==e[0]&&""!==e[1]&&""!==e[2]&&(i.inUpdateCycle=!0,o.centerAndZoom([e[0],e[1]],e[2]).then(function(){i.inUpdateCycle=!1}))}),r.$on("$destroy",function(){i.deregister&&i.deregister(),o.destroy()})})},o=s.webmapId?n.createWebMap(s.webmapId,s.id,this.getMapOptions(),this):n.createMap(s.id,this.getMapOptions()),s.registerAs&&(this.deregister=i._register(s.registerAs,o))}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriMap",function(){return{restrict:"E",scope:{center:"=?",zoom:"=?",itemInfo:"=?",basemap:"@",load:"&",extentChange:"&",mapOptions:"&"},controllerAs:"mapCtrl",bindToController:!0,controller:"EsriMapController",compile:function(e,r){return e.removeAttr("id"),e.append("<div id="+r.id+"></div>"),function(e,r,t,n){n.bindMapEvents(e,t)}}}})}(angular),function(e){"use strict";e.module("esri.map").directive("esriLegend",["$q","esriLoader",function(e,r){return{priority:-10,restrict:"EA",require:["?esriLegend","^esriMap"],replace:!0,scope:{},controllerAs:"legendCtrl",bindToController:!0,controller:function(){},link:function(t,n,i,a){var o=a[1],s=i.targetId||i.id,u=e.defer();r.require(["esri/dijit/Legend"],function(e){o.getMap().then(function(r){var n,i={map:r},a=o.getLayerInfos();a&&(i.layerInfos=a),n=new e(i,s),n.startup(),t.$watchCollection(function(){return o.getLayerInfos()},function(e){n.refresh(e)}),u.resolve(n),t.$on("$destroy",function(){n.destroy()})})})}}}])}(angular),function(e){"use strict";e.module("esri.map").controller("EsriLayerControllerBase",function(){function r(e){return e===!0||"true"===e}this.getLayerOptions=function(){var t=this.layerOptions()||{};return e.isDefined(this.visible)&&(t.visible=r(this.visible)),this.opacity&&(t.opacity=Number(this.opacity)),t},this.getLayerInfo=function(e,r){return{title:r.title||e.name,layer:e,hideLayers:r.hideLayers?r.hideLayers.split(",").map(Number):void 0,defaultSymbol:r.defaultSymbol?JSON.parse(r.defaultSymbol):!0}},this._bindLayerEvents=function(e,t,n,i){t.load&&(n.loaded?e.layerCtrl.load()(n):n.on("load",function(){e.$apply(function(){e.layerCtrl.load()(n)})})),t.updateEnd&&n.on("update-end",function(r){e.$apply(function(){e.layerCtrl.updateEnd()(r)})}),e.$watch("layerCtrl.visible",function(e,t){e!==t&&n.setVisibility(r(e))}),e.$watch("layerCtrl.opacity",function(e,r){e!==r&&n.setOpacity(Number(e))}),e.$on("$destroy",function(){i.removeLayer(n)})}})}(angular),function(e){"use strict";e.module("esri.map").controller("EsriFeatureLayerController",["$controller","esriLayerUtils",function(r,t){var n;e.extend(this,r("EsriLayerControllerBase")),this.getFeatureLayerOptions=function(){var e=this.getLayerOptions();return this.definitionExpression&&(e.definitionExpression=this.definitionExpression),e},this.getLayer=function(){return n},this.setInfoTemplate=function(e){return this.getLayer().then(function(r){return t.createInfoTemplate(e).then(function(e){return r.setInfoTemplate(e),e})})},this.bindLayerEvents=function(e,r,t,n){this._bindLayerEvents(e,r,t,n),e.$watch("layerCtrl.definitionExpression",function(e,r){e!==r&&t.setDefinitionExpression(e)})},n=t.createFeatureLayer(this.url,this.getFeatureLayerOptions())}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriFeatureLayer",function(){return{restrict:"E",require:["esriFeatureLayer","^esriMap"],replace:!0,scope:{url:"@",visible:"@?",opacity:"@?",definitionExpression:"@?",load:"&",updateEnd:"&",layerOptions:"&"},controllerAs:"layerCtrl",bindToController:!0,controller:"EsriFeatureLayerController",link:function(e,r,t,n){var i=n[0],a=n[1];i.getLayer().then(function(r){var n=i.getLayerInfo(r,t);a.addLayer(r,0),a.addLayerInfo(n),i.bindLayerEvents(e,t,r,a)})}}})}(angular),function(e){"use strict";e.module("esri.map").controller("EsriDynamicMapServiceLayerController",["$controller","esriLayerUtils",function(r,t){var n;e.extend(this,r("EsriLayerControllerBase")),this.getLayer=function(){return n},this.setInfoTemplate=function(r,n){return this.getLayer().then(function(i){return t.createInfoTemplate(n).then(function(t){var n=i.infoTemplates;return e.isObject(n)||(n={}),n[r]={infoTemplate:t},i.setInfoTemplates(n),n})})},this.bindLayerEvents=function(e,r,t,n){this._bindLayerEvents(e,r,t,n)},n=t.createDynamicMapServiceLayer(this.url,this.getLayerOptions(),this.visibleLayers)}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriDynamicMapServiceLayer",function(){return{restrict:"E",require:["esriDynamicMapServiceLayer","^esriMap"],replace:!0,scope:{url:"@",visible:"@?",opacity:"@?",visibleLayers:"@?",load:"&",updateEnd:"&",layerOptions:"&"},controllerAs:"layerCtrl",bindToController:!0,controller:"EsriDynamicMapServiceLayerController",link:function(e,r,t,n){var i=n[0],a=n[1];i.getLayer().then(function(r){var n=i.getLayerInfo(r,t);a.addLayer(r),a.addLayerInfo(n),i.bindLayerEvents(e,t,r,a)})}}})}(angular),function(e){"use strict";e.module("esri.map").directive("esriInfoTemplate",function(){return{restrict:"E",require:["?esriInfoTemplate","?^esriDynamicMapServiceLayer","?^esriFeatureLayer"],replace:!0,compile:function(e){var r=e.html();return e.html(""),function(e,t,n,i){var a=i[1],o=i[2];a&&a.setInfoTemplate(n.layerId,{title:n.title,content:r}),o&&o.setInfoTemplate({title:n.title,content:r})}}}})}(angular);