!function(e){"use strict";e.module("esri.map",[]),e.module("esri.map").factory("esriLoader",["$q",function(r){function t(t){var i=r.defer();e.isDefined(window.esri)&&i.reject("ESRI API is already loaded."),t=e.isDefined(t)?t:{};var n=document.createElement("script");return n.type="text/javascript",n.src=t.url||"http://js.arcgis.com/3.14compact",n.onload=function(){i.resolve(window.esri)},document.body.appendChild(n),i.promise}function i(){return e.isDefined(window.esri)}function n(t,n){var o=r.defer();return i()?(e.isString(t)?require([t],function(r){n&&e.isFunction(n)&&n(r),o.resolve(r)}):e.isArray(t)?require(t,function(){var r=Array.prototype.slice.call(arguments);n&&e.isFunction(n)&&n.apply(this,r),o.resolve(r)}):o.reject("An Array<String> or String is required to load modules."),o.promise):(o.reject("Trying to call esriLoader.require(), but esri API has not been loaded yet. Run esriLoader.bootstrap() if you are lazy loading esri ArcGIS API."),o.promise)}return{bootstrap:t,isLoaded:i,require:n}}])}(angular),function(e){"use strict";e.module("esri.map").service("esriRegistry",["$q",function(e){var r={};return{_register:function(t,i){r[t]||(r[t]=e.defer());var n=r[t];return i.promise.then(function(e){return n.resolve(e),e},function(e){return n.reject(e),e}),function(){delete r[t]}},get:function(t){if(r[t])return r[t].promise;var i=e.defer();return r[t]=i,i.promise}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriMap",["$q","$timeout","esriRegistry",function(r,t,i){return{restrict:"E",scope:{center:"=?",zoom:"=?",itemInfo:"=?",basemap:"@",load:"&",extentChange:"&"},compile:function(e,r){return e.removeAttr("id"),e.append("<div id="+r.id+"></div>"),function(){}},controller:["$scope","$element","$attrs",function(n,o,a){var s=r.defer();if(a.registerAs){var c=i._register(a.registerAs,s);n.$on("$destroy",c)}require(["esri/map","esri/arcgis/utils"],function(r,i){if(a.webmapId)i.createMap(a.webmapId,a.id).then(function(e){s.resolve(e.map);var r=e.map.geographicExtent.getCenter();n.center.lng=r.x,n.center.lat=r.y,n.zoom=e.map.getZoom(),n.itemInfo=e.itemInfo});else{var o={};if(a.extent?o.extent=n[a.extent]:(n.center.lng&&n.center.lat?o.center=[n.center.lng,n.center.lat]:n.center&&(o.center=n.center),n.zoom&&(o.zoom=n.zoom)),n.basemap&&(o.basemap=n.basemap),a.navigationMode){if("css-transforms"!==a.navigationMode&&"classic"!==a.navigationMode)throw new Error("navigationMode must be 'css-transforms' or 'classic'.");o.navigationMode=a.navigationMode}if(a.sliderOrientation){if("horizontal"!==a.sliderOrientation&&"vertical"!==a.sliderOrientation)throw new Error("sliderOrientation must be 'horizontal' or 'vertical'.");o.sliderOrientation=a.sliderOrientation}if(a.sliderPosition){var c=["top-left","top-right","bottom-left","bottom-right"];if(c.indexOf(a.sliderPosition)<0)throw new Error("sliderPosition must be in "+c);o.sliderPosition=a.sliderPosition}if(a.sliderStyle){if("large"!==a.sliderStyle&&"small"!==a.sliderStyle)throw new Error("sliderStyle must be 'large' or 'small'.");o.sliderStyle=a.sliderStyle}var l=["autoResize","displayGraphicsOnPan","fadeOnZoom","fitExtent","force3DTransforms","logo","nav","optimizePanAnimation","showAttribution","showInfoWindowOnClick","slider","smartNavigation","wrapAround180"];e.forEach(l,function(e){"undefined"!=typeof a[e]&&(o[e]="true"===a[e].toString())});var u=["attributionWidth","maxScale","maxZoom","minScale","minZoom","resizeDelay","scale"];e.forEach(u,function(e){a[e]&&(o[e]=a[e])});var d=new r(a.id,o);s.resolve(d)}s.promise.then(function(e){e.on("load",function(){a.load&&n.$apply(function(){n.load()(e)})}),n.$watch("basemap",function(r,t){e.loaded&&r!==t&&e.setBasemap(r)}),n.inUpdateCycle=!1,n.$watch(function(e){return[e.center.lng,e.center.lat,e.zoom].join(",")},function(r){n.inUpdateCycle||(r=r.split(","),""!==r[0]&&""!==r[1]&&""!==r[2]&&(n.inUpdateCycle=!0,e.centerAndZoom([r[0],r[1]],r[2]).then(function(){n.inUpdateCycle=!1})))}),e.on("extent-change",function(r){n.inUpdateCycle||(n.inUpdateCycle=!0,n.$apply(function(){var i=e.geographicExtent.getCenter();n.center.lng=i.x,n.center.lat=i.y,n.zoom=e.getZoom(),a.extentChange&&n.extentChange()(r),t(function(){n.inUpdateCycle=!1},0)}))}),n.$on("$destroy",function(){e.destroy()})})}),this.getMap=function(){return s.promise},this.addLayer=function(e){return this.getMap().then(function(r){return r.addLayer(e)})},this.addLayerInfo=function(e){this.layerInfos?this.layerInfos.push(e):this.layerInfos=[e]},this.getLayerInfos=function(){return this.layerInfos}}]}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriFeatureLayer",["$q",function(e){return{restrict:"E",require:["esriFeatureLayer","^esriMap"],replace:!0,controller:["$scope","$element","$attrs",function(r,t,i){var n=e.defer();require(["esri/layers/FeatureLayer"],function(e){var r=new e(i.url);n.resolve(r)}),this.getLayer=function(){return n.promise},this.setVisible=function(r){var t=e.defer();return this.getLayer().then(function(e){r?e.show():e.hide(),t.resolve()}),t.promise}}],link:function(e,r,t,i){var n=i[0],o=i[1],a=t.visible||"true",s=e.$eval(a);n.setVisible(s),e.$watch(function(){return e.$eval(t.visible)},function(e,r){e!==r&&n.setVisible(e)}),n.getLayer().then(function(e){return o.addLayer(e),o.addLayerInfo({title:t.title||e.name,layer:e,hideLayers:t.hideLayers?t.hideLayers.split(","):void 0,defaultSymbol:t.defaultSymbol?JSON.parse(t.defaultSymbol):!0}),e})}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriLegend",["$document","$q",function(r,t){return{priority:-10,scope:{},replace:!0,require:["^esriMap"],link:function(r,i,n,o){var a=o[0],s=n.targetId||n.id,c=t.defer();require(["esri/dijit/Legend","dijit/registry"],function(t,i){a.getMap().then(function(n){var o={map:n},l=a.getLayerInfos();l&&(o.layerInfos=l);var u=i.byId(s);u&&u.destroyRecursive(),u=new t(o,s),u.startup(),r.layers=u.layers,e.forEach(r.layers,function(e,t){r.$watch("layers["+t+"].renderer",function(){u.refresh()})}),c.resolve(u)})})}}}])}(angular);