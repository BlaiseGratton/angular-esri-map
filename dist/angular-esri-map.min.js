!function(e){"use strict";e.module("esri.map",[]),e.module("esri.map").factory("esriLoader",["$q",function(t){return function(r){var n=t.defer();return e.isString(r)?require([r],function(e){n.resolve(e)}):e.isArray(r)?require(r,function(e){n.resolve(e)}):n.reject("An Array<String> or String is required to load modules."),n.promise}}])}(angular),function(e){"use strict";e.module("esri.map").service("esriRegistry",["$q",function(e){var t={};return{_register:function(r,n){t[r]||(t[r]=e.defer());var i=t[r];return n.promise.then(function(e){return i.resolve(e),e},function(e){return i.reject(e),e}),function(){delete t[r]}},get:function(r){if(t[r])return t[r].promise;var n=e.defer();return t[r]=n,n.promise}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriMap",["$q","$timeout","esriRegistry",function(t,r,n){return{restrict:"E",scope:{center:"=?",zoom:"=?",itemInfo:"=?",basemap:"@",load:"&",extentChange:"&"},compile:function(e,t){return e.removeAttr("id"),e.append("<div id="+t.id+"></div>"),function(){}},controller:["$scope","$element","$attrs",function(i,o,a){var s=t.defer();if(a.registerAs){var l=n._register(a.registerAs,s);i.$on("$destroy",l)}require(["esri/map","esri/arcgis/utils"],function(t,n){if(a.webmapId)n.createMap(a.webmapId,a.id).then(function(e){s.resolve(e.map);var t=e.map.geographicExtent.getCenter();i.center.lng=t.x,i.center.lat=t.y,i.zoom=e.map.getZoom(),i.itemInfo=e.itemInfo});else{var o={};if(a.extent?o.extent=i[a.extent]:(i.center.lng&&i.center.lat?o.center=[i.center.lng,i.center.lat]:i.center&&(o.center=i.center),i.zoom&&(o.zoom=i.zoom)),i.basemap&&(o.basemap=i.basemap),a.navigationMode){if("css-transforms"!==a.navigationMode&&"classic"!==a.navigationMode)throw new Error("navigationMode must be 'css-transforms' or 'classic'.");o.navigationMode=a.navigationMode}if(a.sliderOrientation){if("horizontal"!==a.sliderOrientation&&"vertical"!==a.sliderOrientation)throw new Error("sliderOrientation must be 'horizontal' or 'vertical'.");o.sliderOrientation=a.sliderOrientation}if(a.sliderPosition){var l=["top-left","top-right","bottom-left","bottom-right"];if(l.indexOf(a.sliderPosition)<0)throw new Error("sliderPosition must be in "+l);o.sliderPosition=a.sliderPosition}if(a.sliderStyle){if("large"!==a.sliderStyle&&"small"!==a.sliderStyle)throw new Error("sliderStyle must be 'large' or 'small'.");o.sliderStyle=a.sliderStyle}var c=["autoResize","displayGraphicsOnPan","fadeOnZoom","fitExtent","force3DTransforms","logo","nav","optimizePanAnimation","showAttribution","showInfoWindowOnClick","slider","smartNavigation","wrapAround180"];e.forEach(c,function(e){"undefined"!=typeof a[e]&&(o[e]="true"===a[e].toString())});var u=["attributionWidth","maxScale","maxZoom","minScale","minZoom","resizeDelay","scale"];e.forEach(u,function(e){a[e]&&(o[e]=a[e])});var f=new t(a.id,o);s.resolve(f)}s.promise.then(function(e){e.on("load",function(){a.load&&i.$apply(function(){i.load()(e)})}),i.$watch("basemap",function(t,r){e.loaded&&t!==r&&e.setBasemap(t)}),i.inUpdateCycle=!1,i.$watch(function(e){return[e.center.lng,e.center.lat,e.zoom].join(",")},function(t){i.inUpdateCycle||(t=t.split(","),""!==t[0]&&""!==t[1]&&""!==t[2]&&(i.inUpdateCycle=!0,e.centerAndZoom([t[0],t[1]],t[2]).then(function(){i.inUpdateCycle=!1})))}),e.on("extent-change",function(t){i.inUpdateCycle||(i.inUpdateCycle=!0,i.$apply(function(){var n=e.geographicExtent.getCenter();i.center.lng=n.x,i.center.lat=n.y,i.zoom=e.getZoom(),a.extentChange&&i.extentChange()(t),r(function(){i.inUpdateCycle=!1},0)}))}),i.$on("$destroy",function(){e.destroy()})})}),this.getMap=function(){return s.promise},this.addLayer=function(e){return this.getMap().then(function(t){return t.addLayer(e)})},this.addLayerInfo=function(e){this.layerInfos?this.layerInfos.push(e):this.layerInfos=[e]},this.getLayerInfos=function(){return this.layerInfos}}]}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriFeatureLayer",["$q",function(e){return{restrict:"E",require:["esriFeatureLayer","^esriMap"],replace:!0,controller:["$scope","$element","$attrs",function(t,r,n){var i=e.defer();require(["esri/layers/FeatureLayer"],function(e){var t=new e(n.url);i.resolve(t)}),this.getLayer=function(){return i.promise}}],link:function(e,t,r,n){var i=n[0],o=n[1];i.getLayer().then(function(e){return o.addLayer(e),o.addLayerInfo({title:r.title||e.name,layer:e,hideLayers:r.hideLayers?r.hideLayers.split(","):void 0,defaultSymbol:r.defaultSymbol?JSON.parse(r.defaultSymbol):!0}),e})}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriDynamicMapServiceLayer",["$q",function(t){return{restrict:"E",require:["esriDynamicMapServiceLayer","^esriMap"],replace:!0,controller:["$scope","$element","$attrs",function(r,n,i){var o=this;o.InfoTemplates=[];var a=t.defer();require(["esri/layers/ArcGISDynamicMapServiceLayer","esri/InfoTemplate"],function(t,r){var n=new t(i.url);n.setOpacity(i.opacity),n.visible="true"===i.visible.toString().toLowerCase(),n.setVisibleLayers(i.visibleLayers?i.visibleLayers.split(","):[-1]),i.imageFormat&&n.setImageFormat(i.imageFormat);var s={};e.forEach(o.InfoTemplates,function(t){var n=t.layerIDs.split(",");e.forEach(n,function(e){var n=new r({title:t.title,content:t.content});s[e]={infoTemplate:n}})}),n.setInfoTemplates(s),a.resolve(n)}),this.getLayer=function(){return a.promise}}],link:function(e,t,r,n){var i=n[0],o=n[1];i.getLayer().then(function(e){return o.addLayer(e),o.addLayerInfo({title:r.title||e.name,layer:e,hideLayers:r.hideLayers?r.hideLayers.split(","):void 0,defaultSymbol:r.defaultSymbol?JSON.parse(r.defaultSymbol):!0}),e})}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriInfoTemplate",function(){return{restrict:"E",require:["esriInfoTemplate","^esriDynamicMapServiceLayer"],replace:!0,controller:["$scope","$element","$attrs",function(){}],link:function(e,t,r,n){t.addClass("hidden");var i=(n[0],n[1]);i.InfoTemplates.push({layerIDs:r.layerIds,title:r.title,content:t.html()})}}})}(angular),function(e){"use strict";e.module("esri.map").directive("esriLegend",["$document","$q",function(e,t){return{priority:-10,scope:{},replace:!0,require:["^esriMap"],link:function(e,r,n,i){var o=i[0],a=n.targetId||n.id,s=t.defer();require(["esri/dijit/Legend","dijit/registry"],function(t,r){o.getMap().then(function(n){var i={map:n},l=o.getLayerInfos();l&&(i.layerInfos=l);var c=r.byId(a);c&&c.destroyRecursive(),c=new t(i,a),c.startup(),e.$watchCollection(function(){return o.getLayerInfos()},function(e){c.refresh(e)}),s.resolve(c)})})}}}])}(angular);